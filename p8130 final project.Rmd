---
title: "p8130 final project"
author: "chianti shi"
date: "12/8/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(haven)
library(rvest)
library(stringr)
library(forcats)
```


Loading and cleaning the dataset
```{r, include=FALSE}
hospital_data = readxl::read_excel("./data/GHProject_Dataset.xlsx") %>%
  clean_names() %>% 
  mutate(patientid = as.character(patientid)) 

hospital_visit = hospital_data %>% 
  group_by(patientid) %>% 
  summarize(visit_num = n()) %>% 
  inner_join(hospital_data, hospital_visit, by = "patientid") %>% 
  separate(., admitdtm, into = c("dayofweek","date","year"), sep = ",") %>% 
  mutate(visit_num = as.numeric(visit_num)) 

hospital_visit %>% 
 mutate(date = str_replace(date, "January ", "01"),
        date = str_replace(date, "February ", "02"),
        date = str_replace(date, "March ", "03"),
        date = str_replace(date, "April ", "04"),
        date = str_replace(date, "May ", "05"),
        date = str_replace(date, "June ", "06"),
        date = str_replace(date, "July ", "07"),
        date = str_replace(date, "August ", "08"),
        date = str_replace(date, "September ", "09"),
        date = str_replace(date, "October ", "10"),
        date = str_replace(date, "November ", "11"),
        date = str_replace(date, "December ", "12")) %>% 
  mutate(date = as.numeric(date)) %>% 
  #arrange(date) %>% 
  group_by(patientid, date) %>% 
  filter(visit_num > 1) 
  
  
  
         
```



